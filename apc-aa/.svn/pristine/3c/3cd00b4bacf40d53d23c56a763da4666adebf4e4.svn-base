function buildSearchesList(searches,searchesList,form,container,text){searchesList.empty();if(searches.length){searchesList.append($("<div class=aa-form-saver__lbl>"+text+"</div>"))}var btn_counter=0;for(var i=0;i<searches.length;i++){var params=JSON.parse('{"'+decodeURIComponent(searches[i].replace(/&/g,'","').replace(/=/g,'":"').replace(/\+/g," "))+'"}');var firstinput;for(firstinput in params){break}(function(searchData){var btn_text=params[firstinput];if(btn_text.length==0){btn_text="-"+ ++btn_counter+"-"}else if(btn_text.length>16){btn_text=btn_text.substring(0,16)+"â€¦"}searchesList.append($("<span tabindex=0 class=aa-form-saver__btn>").text(btn_text).on("click keypress",function(event){if(event.type!=="keypress"||event.keyCode===13||event.keyCode===32){if(container==""){form.trigger("reset")}else{$(container+" input:checkbox").prop("checked",false);$(container+" select:selected").prop("selected",false)}form.deserialize(searchData)}}))})(searches[i])}}function FormSaver(search_id,container,text){var searchesList=$("#aa-fs-"+search_id);var form=$(container==""?"#aa-fs-"+search_id:container).closest("form");var searches=window.localStorage.getItem("aafs_"+search_id);searches=searches===null?[]:JSON.parse(searches);buildSearchesList(searches,searchesList,form,container,text);form.submit(function(event){if(container==""){var currentSearch=form.serialize()}else{var currentSearch=$(container+" input, "+container+" select, "+container+" textarea").serialize()}searches.unshift(currentSearch);for(var i=1;i<searches.length;i++){if(searches[0]===searches[i]){searches.splice(i,1)}}if(i===searches.length&&searches.length>5){searches.pop()}window.localStorage.setItem("aafs_"+search_id,JSON.stringify(searches));buildSearchesList(searches,searchesList,form,container,text)})}